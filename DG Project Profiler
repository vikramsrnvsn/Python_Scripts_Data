import sqlite3
import pandas as pd

# Connect to the SQLite database
conn = sqlite3.connect('your_database.db')

# List of tables in the database
tables = ['table1', 'table2', 'table3', 'table4', 'table5', 'table6', 'table7', 'table8']

# Loop through each table and export to CSV
for table in tables:
    query = f"SELECT * FROM {table};"
    df = pd.read_sql_query(query, conn)
    df.to_csv(f'{table}.csv', index=False)

# Combine CSV files into one spreadsheet
combined_df = pd.concat([pd.read_csv(f'{table}.csv') for table in tables], ignore_index=True)
combined_df.to_excel('combined_tables.xlsx', index=False)

# Close the connection
conn.close()
